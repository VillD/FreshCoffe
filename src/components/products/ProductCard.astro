---
import { Picture } from 'astro:assets'
import type { Product, ProductWithVariablePrice } from '@/types'
import {formatCurrency} from '@/utils'
import PriceWithVariants from './PriceWithVariants.astro'
import AddProductButton from './AddProductButton'

interface Props {
	product: Product
}

const { product } = Astro.props
// const addProduct = {
//   id: product.id,
//   title: product.title.rendered,
//   price: product.acf.price
// }
---

<div class='border-2 border-gray-200'>
	<Picture
		src={product.featured_images.full.url}
		alt={product.title.rendered}
		width={product.featured_images.full.width}
		height={product.featured_images.full.height}
    formats={['avif', 'webp']}'
    class='w-full h-96 object-cover object-center'
	/>
	<div class='p-5 bg-white'>
		<h3 class='text-xl font-black text-gray-900' set:html={product.title.rendered}></h3>
        {product.acf.variable_price 
        ? <PriceWithVariants product={product as ProductWithVariablePrice}/> 
        : (
            <p class="mt-5 font-black text-amber-400 text-xl">{formatCurrency(product.acf.price)}</p>
            <AddProductButton 
              client:only="react" 
              product={{
                id: product.id,
                name: product.title.rendered,
                price: product.acf.price
              }}
            />
        )}
	</div>
</div>
