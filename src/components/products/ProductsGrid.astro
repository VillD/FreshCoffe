---
import { ProductsSchema } from '@/types'
import ProductCard from './ProductCard.astro';
import ShowOrderButton from '@/components/order/ShowOrderButton'

const { category } = Astro.params;
const url = `${import.meta.env.API_URL}/freshcoffee_products?freshcoffee_category_slug=${category}&per_page=20`;
const res = await fetch(url);
const json = await res.json();
const products = ProductsSchema.parse(json);

---
<div class="flex justify-between">
    <h1 class="text-2xl my-10">Elige y Personaliza tu pedido a continuaci√≥n</h1>
    <ShowOrderButton client:only="react"/>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4 items-stretch">
    {products.map((product) => (
        <ProductCard product={product} />
    ))}
</div>